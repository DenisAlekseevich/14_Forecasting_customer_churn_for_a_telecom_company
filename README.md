# Прогнозирование оттока клиентов телеком компании

## Задача проекта

Оператор связи «Ниединогоразрыва.ком» хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах. 

Описание услуг:
- основные типы услуг:
  - стационарная телефонная связь, возможно подключение телефонного аппарата к нескольким линиям одновременно;
  - интернет: через телефонную линию (DSL, от англ. digital subscriber line, «цифровая абонентская линия») или оптоволоконный кабель (Fiber optic);
- дополнительные услуги:
  - интернет-безопасность: антивирус (DeviceProtection) и блокировка небезопасных сайтов (OnlineSecurity);
  - выделенная линия технической поддержки (TechSupport);
  - облачное хранилище файлов для резервного копирования данных (OnlineBackup);
  - стриминговое телевидение (StreamingTV) и каталог фильмов (StreamingMovies).

За услуги клиенты могут платить каждый месяц или заключить договор на 1–2 года. Доступны различные способы расчёта и возможность получения электронного чека.

Данные состоят из файлов, полученных из разных источников:
- contract.csv — информация о договоре;
- personal.csv — персональные данные клиента;
- internet.csv — информация об интернет-услугах;
- phone.csv — информация об услугах телефонии.

Во всех файлах столбец customerID содержит код клиента.

## Инструменты и навыки

`Pandas`
`Numpy`
`Matplotlib`
`Seaborn`
`Scikit-learn`
`Catboost`
`LightGBM`
`исследовательский анализ`
`машинное обучение`

## Краткое описание выполнения проекта

Загружены и проанализированы данные, обработаны пропуски, аномалии и дубликаты. Добавлены новые фичи и целевой признак, данные объеденены в единый датафрейм.

Произведен сравнительный анализ различных признаков для ушедших и оставшихся клиентов, построены графики для наглядности. Выявлены признаки, являющиеся лишними и бесполезные при обучении моделей.

Произведена подготовка данных перед обучением моделей: работа с дисбалансом классов, кодирование, масштабирование. Обучены и протестированы модели. Выбрана лучшая.

## Данные и выводы

На подготовелнных данных обучены модели **дерева решений**, **случайного леса**, **логистической регрессии** и **градиентного бустинга**, дополнительно использовались бибклиотеки **CatBoost**, **LightGBM**. Лучше всего показали себя модели градиентного бустинга. По результатам тестирования лучших моделей выбор был остановлен на **GradientBoostingClassifier** из-за высоких значений метрик и скорости работы. 

После удаления малозначимых признаков и переобучении модели метрики стали следующими:
- _**AUC-ROC**_ = 0.93170;
- _**Accuracy**_ = 0.87722;
- _**Recall**_ = 0.94976;
- _**Precision**_ = 0.89040.

Какие-то незначительно выросли, какие-то незначительно упали. В целом картина изменилась не сильно.

Так же пости на 1/3 уменьшилось время обучения модели.

Что касается признаков, влияющих на предсказания модели, то можно выделить:
- _LifeTime_ - время жизни клиента(наиболее значимый признак);
- _InternetService_Fiber optic_ - подключение интернета через оптоволокно;
- _MonthlyCharges_ - ежемесячный платеж;
- _PaymentMethod_Electronic check_ - оплата электронным чеком.

При анализе данных были сделаны следующие наблюдения и выводы:

- отключаться клиенты начали с 2019 года и максимум отключившихся приходится на подключившихся в том же году;
- среди ушедших клиентов преобладают люди допенсионного возраста, без детей и супруга, а так же те, что пользовался интернетом через оптоволокно;
- около 90% ушедших клиентов пользовались помесячной оплатой услуг провайдера, так же в среднем месячная плата ушедших клиентов была выше, чем у оставшихся (медианное значение - 80 против 64 у оставшихся);
- выяснилось, что чем меньше человек являлся клиентом компании, тем выше была вероятноть того, что он отключится: значительная часть клиентов ушли после первого-второго месяца пользования услуг компании.

Подытожив можно сказать, что у компании либо изменилась ценовая политика, либо по каким-то причинам понизилось качество оказываемых услуг и поддержки(вполне вероятно и из-за роста количества клиентом), либо появился конкурент.
